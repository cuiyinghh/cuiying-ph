(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-00ac11fe"],{"0423":function(t,e,a){"use strict";var n=a("bea4");a.n(n).a},1217:function(t,e,a){t.exports=a.p+"img/small.a2459e6c.png"},"7abe":function(t,e,a){"use strict";a.r(e);var n=a("5880"),i=(a("2cbd"),a("ab2c")),o=a("862d"),s=a.n(o),r=(a("ed08"),a("5118"));var c,l,h,u={name:"map",components:(c={},l=i.a.name,h=i.a,l in c?Object.defineProperty(c,l,{value:h,enumerable:!0,configurable:!0,writable:!0}):c[l]=h,c),props:{},data:function(){return{showSheet:!1,sheetData:{title:"",content:"",currentMark:null},geo:{lat:0,lng:0},navGeo:{},testTxt:""}},mounted:function(){this.loadMapPromise=this.initAMap()},computed:{isShowRouteBtn:function(){return this.geo.lat&&this.geo.lng}},watch:{},methods:{initAMap:function(){var t=this;return new Promise((function(e,n){s.a.load({key:"aaa4c7d4873757deb1f5ceff26e8bbb9",version:"2.0",plugins:["AMap.Geolocation","AMap.Walking","AMap.TileLayer","AMap.ImageLayer","AMap.Bounds"]}).then((function(n){var i=new n.ImageLayer({url:a("1217"),bounds:new n.Bounds([125.181739,43.835724],[125.220817,43.856736]),zooms:[10,20],zIndex:10});t.map=new n.Map("container",{viewMode:"2D",zoom:15,center:[125.209476,43.849681],layers:[n.createDefaultLayer(),i]}),t.AMap=n,t.locateH5(),t.map.on("click",(function(e){t.hideDlg(),t.hideWalking()})),e()})).catch((function(t){n(t)}))}))},locateH5:function(){var t=this;this.loadMapPromise.finally((function(){t.testTxt="开始定位!!!",navigator&&navigator.geolocation&&(t.testTxt="".concat(t.testTxt," ====== 有navigator"),t.navLocateWatch=navigator.geolocation.watchPosition((function(e){var a=e.coords.latitude,n=e.coords.longitude;t.testTxt="".concat(t.testTxt," ======================= nav获取的经纬度: ").concat(n+"~"+a),+n!=+t.navGeo.lng||+a!=+t.navGeo.lat?t.AMap.convertFrom([n,a],"gps",(function(e,i){t.testTxt="".concat(t.testTxt," =====高德转换后的经纬度 ").concat(JSON.stringify(i)),t.navGeo={lng:n,lat:a},t.geo=i.locations[0],t.updateGeoShow()})):t.testTxt="".concat(t.testTxt," === 【没变 不用转换】")}),(function(t){}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:10}))}))},updateGeoShow:function(){this.geoMarker?(this.geoMarker.setPosition(new this.AMap.LngLat(this.geo.lng,this.geo.lat)),this.geoCircle.setCenter(new this.AMap.LngLat(this.geo.lng,this.geo.lat))):(this.geoMarker=new this.AMap.Marker({position:new this.AMap.LngLat(this.geo.lng,this.geo.lat),icon:new this.AMap.Icon({size:new this.AMap.Size(20,20),imageSize:new this.AMap.Size(20,20),image:"https://a.amap.com/jsapi/static/image/plugin/point.png",imageOffset:new this.AMap.Pixel(0,0)}),anchor:"center"}),this.map.add(this.geoMarker),this.moveCenter([this.geo.lng,this.geo.lat]),this.geoCircle=new this.AMap.Circle({center:new this.AMap.LngLat(this.geo.lng,this.geo.lat),radius:50,strokeColor:"#216BFF",strokeOpacity:.4,strokeWeight:1,fillColor:"#e3edff",fillOpacity:.5}),this.map.add(this.geoCircle))},moveCenter:function(t){this.map&&this.map.setCenter(t)},markPoints:function(t){var e=this;t&&t.length&&this.loadMapPromise.finally((function(){t.forEach((function(t){var a=new e.AMap.Marker({position:new e.AMap.LngLat(t.lng,t.lat),icon:new e.AMap.Icon({image:t.icon||"https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",imageOffset:new e.AMap.Pixel(0,0)}),anchor:"bottom-center",label:{content:t.label||"",direction:"bottom",offset:new e.AMap.Pixel(0,5)}});a.rawData=t,e.map.add(a),a.on("click",(function(n){e.moveCenter([t.lng,t.lat]),t.des_title&&e.showDlg({title:t.des_title,content:t.des_detail||"",currentMark:a}),e.hideWalking()}),a)}))}))},showRoute:function(t){var e=this,a=this.sheetData.currentMark;if(a&&this.geo.lng&&a.rawData.lng){var n={map:this.map,hideMarkers:!1,isOutline:!0,outlineColor:"#ffeeee",autoFitView:!0};this.walking=new this.AMap.Walking(n),this.walking.search([this.geo.lng,this.geo.lat],[a.rawData.lng,a.rawData.lat],(function(t,a){e.hideDlg()}))}},hideWalking:function(){this.walking&&this.walking.clear()},showDlg:function(t){this.sheetData=t,this.showSheet=!0},hideDlg:function(){this.showSheet=!1,this.sheetData={}}},beforeDestroy:function(){this.intervalId&&Object(r.clearInterval)(this.intervalId),this.navLocateWatch&&navigator.geolocation.clearWatch(this.navLocateWatch),this.mpInterIDd&&Object(r.clearInterval)(this.mpInterIDd)}},p=(a("dae6"),a("2877"));function g(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?g(Object(a),!0).forEach((function(e){m(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function m(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var d={name:"home",components:{Map:Object(p.a)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"map-wrap"},[a("div",{attrs:{id:"container"}}),a("div",{staticClass:"testtxt"},[t._v(t._s(t.testTxt))]),a("van-action-sheet",{attrs:{overlay:!1,closeable:!1},model:{value:t.showSheet,callback:function(e){t.showSheet=e},expression:"showSheet"}},[a("div",{staticClass:"dlg-wrap"},[a("div",{staticClass:"title-line"},[a("div",{staticClass:"title"},[t._v(t._s(t.sheetData.title))]),t.isShowRouteBtn?a("div",{staticClass:"route-btn",on:{click:function(e){return t.showRoute()}}},[t._v("路线")]):t._e()]),a("div",{staticClass:"content"},[t._v(t._s(t.sheetData.content))])])])],1)}),[],!1,null,"1f3dc54e",null).exports},data:function(){return{}},created:function(){var t=this;this.getBuldings().finally((function(){t.markPoints(t.buildingData)}))},computed:f(f({},Object(n.mapState)(["buildingData"])),Object(n.mapGetters)([])),methods:f(f(f({},Object(n.mapMutations)([])),Object(n.mapActions)(["getBuldings"])),{},{markPoints:function(t){this.$refs.map&&this.$refs.map.markPoints(t)}})},w=(a("0423"),Object(p.a)(d,(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"home-wrap"},[e("div",{staticClass:"map-wrap"},[e("img",{attrs:{src:"https://obs-owp-prd.obs.cn-north-4.myhuaweicloud.com/Dingtalk_20230324090352.jpg"}})])])}],!1,null,"28f15346",null));e.default=w.exports},ac39:function(t,e,a){},bea4:function(t,e,a){},dae6:function(t,e,a){"use strict";var n=a("ac39");a.n(n).a}}]);